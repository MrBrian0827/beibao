<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>多功能模擬器</title>

<!-- favicon -->
<link rel="icon" href="img/coin-icon.png" type="image/png" />

<!-- PWA Manifest -->
<link rel="manifest" href="manifest.json" />

<!-- iOS Safari 用的加入主畫面圖示 -->
<link rel="apple-touch-icon" sizes="180x180" href="img/icon-180.png" />

<!-- 主題色 -->
<meta name="theme-color" content="#2b7a78" />

<style>
:root {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Noto Sans CJK TC', 'Helvetica Neue', Arial;
  --main-color: #2b7a78;
  --main-hover: #3a9996;
  --bg-color: #faf6ec;
  --card-bg: #fff;
  --shadow-color: rgba(0,0,0,0.08);
}

/* 關鍵：切換顯示用 */
.section { display: none; }
.section.active { display: block; }

body {
  margin: 0;
  background: var(--bg-color);
  color: #222;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}
.card {
  background: var(--card-bg);
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 6px 22px var(--shadow-color);
  width: 360px;
  max-width: 95vw;
  text-align: center;
  box-sizing: border-box;
}
h1 {
  margin: 0 0 16px;
  font-size: 20px;
  font-weight: 600;
}
.menu-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 12px;
}
.menu-grid button {
  height: 60px;
  font-size: clamp(1.2em, 2.5vw, 1.6em);
  border-radius: 8px;
  border: none;
  background: var(--main-color);
  color: white;
  cursor: pointer;
  transition: background-color 0.2s ease;
  width: 100%;
  white-space: normal;
  line-height: 1.2;
  padding: 8px 10px;
  word-break: break-word;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
}
.menu-grid button:hover:not(:disabled) {
  background: var(--main-hover);
}
.menu-grid button:disabled {
  background: #99b3b2;
  cursor: not-allowed;
}
.menu-grid button#goToHelp {
  grid-column: span 2;
}

button {
  border-radius: 8px;
  border: none;
  background: var(--main-color);
  color: white;
  cursor: pointer;
  transition: background-color 0.2s ease;
  font-size: 1.5em;
  padding: 15px 0;
}

/* 功能裡執行按鈕統一大小 */
#tossBtn,
#rollDiceBtn,
#flipCoinBtn,
#spinTriggerBtn {
  width: 120px;
  height: 60px;
  font-size: 1.5em;
  border-radius: 8px;
  border: none;
  background: var(--main-color);
  color: white;
  cursor: pointer;
  transition: background-color 0.2s ease;
  margin: 12px auto 0;
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 8px;
}
#tossBtn:hover:not(:disabled),
#rollDiceBtn:hover:not(:disabled),
#flipCoinBtn:hover:not(:disabled),
#spinTriggerBtn:hover:not(:disabled) {
  background: var(--main-hover);
}
#tossBtn:disabled,
#rollDiceBtn:disabled,
#flipCoinBtn:disabled,
#spinTriggerBtn:disabled {
  background: #99b3b2;
  cursor: not-allowed;
}

/* 擲筊結果 */
#tossResult {
  font-size: 1.2em;
  margin-bottom: 12px;
}

/* 擲骰子結果與骰子圖示 */
#diceResult {
  font-size: 1.2em;
  margin-bottom: 12px;
}
#diceVisual img {
  width: 50px;
  height: 50px;
}

/* 擲骰子輸入欄位 */
#diceCount {
  font-size: 1em;
  width: 50px;
  padding: 4px 6px;
  margin-top: 6px;
}

/* 擲硬幣結果 */
#coinResult {
  margin-top: 10px;
  font-weight: bold;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  font-size: 1.2em;
}
#coinResult img {
  width: 80px;
  height: 80px;
  user-select: none;
  pointer-events: none;
}

/* 俄羅斯輪盤結果文字 */
#russianResult {
  margin-top: 8px;
  font-weight: 600;
  font-size: 1.2em;
  min-height: 36px;
  margin-bottom: 12px;
}

/* 俄羅斯輪盤按鈕 */
#spinTriggerBtn,
#globalResetBtn {
  width: 120px;
  height: 60px;
  font-size: 1.5em;
  margin: 12px auto 0;
  padding: 0;
}

/* 保持整體卡片可用空間 */
.card {
  max-width: 95vw;
  width: 360px;
}

/* 其他小調整 */
.cups {
  display: flex;
  justify-content: center;
  gap: 12px;
  margin: 12px 0;
}
.cup {
  width: 120px;
  height: 80px;
  position: relative;
  transform-origin: center;
}
.half {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  width: 110px;
  height: 60px;
  border-radius: 60px 60px 20px 20px / 50px;
  box-shadow: inset 0 -6px 10px rgba(0, 0, 0, 0.06);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  font-weight: 600;
  color: #222;
  background: #f6e7c8;
  user-select: none;
}
.half.curved {
  background: #e8d6b0;
}

/* 手機版放大 */
@media (max-width: 768px) {
  #tossResult {
    font-size: 1.8em;
  }
  #diceResult {
    font-size: 1.8em;
  }
  #diceVisual img {
    width: 75px;
    height: 75px;
  }
  #diceCount {
    font-size: 1.5em;
    width: 60px;
    padding: 6px 8px;
  }
  #coinResult {
    font-size: 1.8em;
    gap: 12px;
  }
  #coinResult img {
    width: 120px;
    height: 120px;
  }
  #russianResult {
    font-size: 1.8em;
    min-height: 48px;
  }
  #spinTriggerBtn,
  #globalResetBtn {
    width: 180px;
    height: 90px;
    font-size: 1.8em;
  }
  .cups {
    gap: 20px;
  }
  .cup {
    width: 180px;
    height: 120px;
  }
  .half {
    width: 160px;
    height: 90px;
    font-size: 20px;
  }
}

/* 各功能區的執行按鈕和返回按鈕間距 */
.section button:not(.backBtn) {
  margin-bottom: 24px;  /* 執行按鈕底下多出空間 */
}

/* 返回主選單按鈕上方加間距 */
.backBtn {
  margin-top: 32px !important;
  padding: 15px 0;
  width: 100%;
}
</style>
</head>
<body>
<div class="card">
  <!-- 主選單 -->
  <div id="menu" class="section active">
    <h1>多功能模擬器</h1>
    <div class="menu-grid">
      <button id="goToToss">🥠 擲筊</button>
      <button id="goToDice">🎲 擲骰子</button>
      <button id="goToCoin">
        <img src="img/coin-icon.png" alt="硬幣" style="width:24px; height:24px; vertical-align:middle; margin-right:6px;">
        擲硬幣
      </button>
      <button id="goToRussian">🔫 俄羅斯輪盤</button>
      <button id="goToHelp">📱 加入手機主畫面說明</button>
    </div>
  </div>

  <!-- 擲筊 -->
  <div id="toss" class="section">
    <h1>杯筊模擬器</h1>
    <div id="tossResult">按「擲筊」開始</div>
    <div class="cups">
      <div class="cup" id="cupA"><div class="half flat" id="aFace">平（正）</div></div>
      <div class="cup" id="cupB"><div class="half flat" id="bFace">平（正）</div></div>
    </div>
    <button id="tossBtn">擲筊</button>
    <button class="backBtn" data-back="menu">返回主選單</button>
  </div>

  <!-- 擲骰子 -->
  <div id="dice" class="section">
    <h1>擲骰子</h1>
    <div id="diceResult"></div>
    <div id="diceVisual"></div>
    <label style="display:block; margin-top:8px; font-size:1em;">擲幾顆（1～6）：
      <input type="number" id="diceCount" min="1" max="6" value="1"/>
    </label>
    <button id="rollDiceBtn">擲骰子</button>
    <button class="backBtn" data-back="menu">返回主選單</button>
  </div>

  <!-- 擲硬幣 -->
  <div id="coin" class="section">
    <h1>擲硬幣</h1>
    <div id="coinResult">
      <img id="coinImg" src="img/coin-head.png" alt="硬幣" />
      <div id="coinText">按下按鈕開始</div>
    </div>
    <button id="flipCoinBtn">
      <img src="img/coin-icon.png" alt="硬幣" style="width:24px; height:24px; vertical-align:middle; margin-right:6px;">
      擲
    </button>
    <button class="backBtn" data-back="menu">返回主選單</button>
  </div>

  <!-- 俄羅斯輪盤 -->
  <div id="russian" class="section">
    <h1>俄羅斯輪盤</h1>
    <div id="russianResult"></div>
    <button id="spinTriggerBtn">扣板機</button>
    <button id="globalResetBtn" style="display:none;">重新開始新局</button>
    <button class="backBtn" data-back="menu">返回主選單</button>
  </div>

  <!-- 使用說明 -->
  <div id="help" class="section">
    <h2>📱 加入手機主畫面說明</h2>
    <h3>iOS（Safari）</h3>
    <ol>
      <li>在 Safari 開啟此網頁</li>
      <li>點選底部「分享」按鈕</li>
      <li>選擇「加入主畫面」</li>
      <li>確認名稱後點選「加入」</li>
    </ol>
    <h3>Android（Chrome）</h3>
    <ol>
      <li>在 Chrome 開啟此網頁</li>
      <li>點選右上角「⋮」選單</li>
      <li>選擇「加到主畫面」或「安裝應用程式」</li>
      <li>確認名稱後點選「加入」</li>
    </ol>
    <button class="backBtn" data-back="menu">返回主選單</button>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const sections = { menu, toss, dice, coin, russian, help };
  function showSection(name){
    Object.values(sections).forEach(s => s.classList.remove('active'));
    sections[name].classList.add('active');
  }
  goToToss.onclick = () => showSection('toss');
  goToDice.onclick = () => showSection('dice');
  goToCoin.onclick = () => showSection('coin');
  goToRussian.onclick = () => { startNewGame(); showSection('russian'); };
  goToHelp.onclick = () => showSection('help');
  document.querySelectorAll('.backBtn').forEach(btn => btn.onclick = e => showSection(e.target.dataset.back));

  tossBtn.onclick = () => {
    tossBtn.disabled = true;
    tossResult.textContent = '擲筊中…';
    cupA.style.animation = 'toss 800ms cubic-bezier(.2,.8,.2,1)';
    cupB.style.animation = 'toss 900ms cubic-bezier(.2,.8,.2,1)';
    const a = Math.random()<0.5?0:1, b = Math.random()<0.5?0:1;
    setTimeout(()=>{
      cupA.style.animation = '';
      cupB.style.animation = '';
      aFace.textContent = a===0?'平（正）':'凹（反）';
      aFace.className = a===0?'half flat':'half curved';
      bFace.textContent = b===0?'平（正）':'凹（反）';
      bFace.className = b===0?'half flat':'half curved';
      if((a===0&&b===1)||(a===1&&b===0)) tossResult.textContent = '聖筊 ✅';
      else if(a===0&&b===0) tossResult.textContent = '笑筊 🤭';
      else tossResult.textContent = '陰筊 ❌';
      tossBtn.disabled = false;
    },850);
  };

  rollDiceBtn.onclick = () => {
    let count = parseInt(diceCount.value);
    if(isNaN(count)||count<1) count=1; if(count>6) count=6;
    diceCount.value = count;
    const rolls = Array.from({length:count}, ()=>Math.floor(Math.random()*6)+1);
    const counts = {};
    rolls.forEach(v => counts[v]=(counts[v]||0)+1);
    diceResult.textContent = `結果：${rolls.join(', ')} / 分布：${Object.keys(counts).sort((a,b)=>a-b).map(k=>`${k}點 × ${counts[k]}顆`).join('，')}`;
    diceVisual.innerHTML = '';
    rolls.forEach(n=>{
      const img=document.createElement('img');
      img.src=`img/dice${n}.png`;
      img.alt=`${n}點`;
      diceVisual.appendChild(img);
    });
  };

  flipCoinBtn.onclick = () => {
  	flipCoinBtn.disabled = true;
  	coinText.textContent = '擲硬幣中…';
	  setTimeout(() => {
	    const isHead = Math.random() < 0.5;
	    coinImg.src = isHead ? 'img/coin-head.png' : 'img/coin-tail.png';
	    coinText.textContent = isHead ? '結果：正面 🟡' : '結果：反面 ⚫';
	    flipCoinBtn.disabled = false;
	  }, 800);
  };

  let bulletPos=0, currentTrigger=0;
  function startNewGame(){
    bulletPos = Math.floor(Math.random()*6)+1;
    currentTrigger=0;
    russianResult.textContent = '遊戲開始';
    spinTriggerBtn.disabled = false;
    globalResetBtn.style.display = 'none';
  }
  spinTriggerBtn.onclick = () => {
    spinTriggerBtn.disabled = true;
    russianResult.textContent = '扣板機中…';
    setTimeout(()=>{
      currentTrigger++;
      if(currentTrigger===bulletPos){
        russianResult.textContent = '中彈💥！';
        globalResetBtn.style.display = 'inline-block';
      } else {
        russianResult.textContent = `未中彈（${currentTrigger}/6）`;
        if(currentTrigger>=6){
          russianResult.textContent = '安全通過';
          globalResetBtn.style.display = 'inline-block';
        } else {
          spinTriggerBtn.disabled = false;
        }
      }
    },800);
  };
  globalResetBtn.onclick = startNewGame;
  startNewGame();
});
</script>
</body>
</html>
